<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <head>
        <th:block th:insert="~{layout/common :: head}"></th:block>
    </head>
<style>
    @media screen and (max-width: 680px) {
    }
</style>

<div class="wrap" id="a01">
    <!-- 오버레이 처리 -->
    <div id="overlay"></div>

    <!-- 컨테이너 -->
    <div id="container">
        <!-- 내비게이션 바 -->
        <th:block th:insert="~{layout/common :: navbar}"></th:block>
    
        <!-- 메인 -->
        <div id="main">

            <div id="loading"><div class="round spinner"></div></div>

            <!-- 헤더 -->
            <th:block th:insert="~{layout/common :: header}"></th:block>
    
            <!-- 바디 -->
            <div id="body">
                <!-- 콘텐트 -->
                <div class="content-wrapper">
                    <!-- 콘텐트 헤더 -->
                    <div class="content-header">
                        <div class="content-title">
                            <span class="ct-text">차량 <span class="search-count"th:text="${#numbers.formatInteger(page.totalElements , 0 , 'COMMA')}" >999,999,999</span>건이 검색되었습니다.</span>
                        </div>
                        <div class="breadcrumb">
                            <a th:href="@{/}" class="bc-item">Home</a>
                            <a class="bc-item">설정</a>
                            <a th:href="@{/admin/config/car}" class="bc-item">차량 설정</a>
                        </div>
                    </div>
                    <!-- 콘텐트 바디 -->
                    <div class="content-body width-1920">
                        <!-- 테이블 아이템 01 -->
                        <div class="content-item">
                            <div class="content-item-header">
                                <div class="header-option">
                                    <div class="search-option">
                                        <span class="option-title">검색어</span>
                                        <input th:value="${param.search}" id="searchText" class="so_input" type="text" placeholder="브랜드, 모델명을 입력하세요.">
                                    </div>
                                    <button id="btnSearch" class="ho_button btn-search hover01 ml-10">검색</button>
                                </div>
                                <div class="button-list">
                                    <button class="ho_button btn-setting_brand hover01">브랜드 설정</button>
                                    <button class="ho_button btn-setting_color hover01">색상 설정</button>
                                </div>
                                <div class="etc-option toggle-target">
                                    <div class="eo-icon hover01"><i class="xi-ellipsis-h"></i></div>
                                    <div class="eo-menus">
                                        <div onclick="javascript:excelDownload(); return false;" class="btn-download_excel">엑셀 다운로드</div>
                                        <div id="btnCreateNew" class="btn-regi_model">모델등록</div>
                                        <div id="btnCreateNewClass" class="btn-regi_model">등급등록</div>
                                        <div id="btnCreateNewTrim" class="btn-regi_model">트림등록</div>
                                        <div class="view-option">
                                            <div class="vo-item toggle-select" onclick="javascript:searchValue(15); return false;">15개씩 보기</div>
                                            <div class="vo-item toggle-select" onclick="javascript:searchValue(30); return false;">30개씩 보기</div>
                                            <div class="vo-item toggle-select" onclick="javascript:searchValue(60); return false;">60개씩 보기</div>
                                            <div class="vo-item toggle-select" onclick="javascript:searchValue(120); return false;">120개씩 보기</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="content-item-body">
                                <div class="table-wrapper">
                                    <div class="table overflow-scroll">
                                        <div class="table-body">
                                            <div class="item-list ti-header">
                                                <div class="t-item">
                                                    <div class="td center-align toggle-target" data-width="12">번호</div>
                                                    <div class="td center-align toggle-target" data-width="44">브랜드</div>
                                                    <div class="td center-align toggle-target" data-width="44">모델</div>
                                                    <div class="td center-align toggle-target" data-width="44">세부</div>
                                                    <div class="td center-align toggle-target" data-width="44">등급</div>
                                                    <div class="td center-align toggle-target" data-width="44">배기량</div>
                                                    <div class="td center-align toggle-target" data-width="44">인기</div>
                                                </div>
                                            </div>
                                            <div class="item-list ti-standard">
                                                <div th:each="item, stat : ${content}" th:id="${item.id}" class="t-item">
                                                    <div th:text="${#numbers.formatInteger(item.id , 0 , 'COMMA')}" class="td center-align">00000000</div>
                                                    <div th:text="${item.carManufacturer}" class="td center-align">현대</div>
                                                    <div th:text="${item.carModel}" class="td center-align">그랜저</div>
                                                    <div th:text="${item.carModelDetail}" class="td center-align">그랜저</div>
                                                    <div th:text="${item.carClass}" class="td center-align">그랜저</div>
                                                    <div th:text="${item.carDisplacement}" class="td center-align">그랜저</div>
                                                    <div th:text="${item.popularType.description}" class="td center-align"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" id="page" th:value="${page.page}">
                                    <input type="hidden" id="size" th:value="${page.size}">
                                    <input type="hidden" id="sort" th:value="${page.sort}">
                                    <input type="hidden" id="direction" th:value="${page.direction}">
                                    <input type="hidden" id="search" th:value="${search}">
                                    <div th:if="${page.totalPages > 0}" class="table-pagination">
                                        <!--
                                        <a th:if="${page.page != 1}" th:href="@{/admin/member(page=${page.page - 1}, size=${page.size})}"
                                           class="tp-first"><img th:src="@{/assets/img/icon-arrow_left2.png}"  alt=""></a>
                                        -->
                                        <a th:if="${page.isFirst == false}"
                                           th:href="@{/admin/config/car(page=${page.page - 1}, size=${page.size}, search=${param.search})}"
                                           class="tp-prev"><img th:src="@{/assets/img/icon-arrow_left.png}"  alt=""></i></a>

                                        <div class="tp-nav">
                                            <a th:each="item, stat : ${ #numbers.sequence(page.startPage, page.endPage)}"
                                               th:classappend="${item == page.page+1 ? 'active' : ''}"
                                               th:href="@{/admin/config/car(page=${item-1}, size=${page.size}, search=${param.search})}"
                                               th:text="${item}"
                                               class="pg_num">1</a>
                                        </div>
                                        <a th:if="${page.isLast == false}"
                                           th:href="@{/admin/config/car(page=${page.page + 1}, size=${page.size}, search=${param.search})}"
                                           class="tp-next"><img th:src="@{/assets/img/icon-arrow_right.png}" alt=""></i></a>
                                        <!--
                                        <a class="tp-last"><img th:src="@{/assets/img/icon-arrow_right2.png}"  alt=""></i></a>
                                        -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    
            <!-- 푸터 -->
            <th:block th:insert="~{layout/common :: footer}"></th:block>
        </div>
    </div>

    <!-- 팝업 -->
    <div class="modal">
        <div class="modal-wrapper main-modal modal-registry_model width-600">
            <div class="modal-header">
                <div class="modal-title">
                    <span id="modal_id" class="mt-text">모델번호 ()</span>
                </div>
                <div class="breadcrumb">
                    <a th:href="@{/}" class="bc-item">Home</a>
                    <a class="bc-item">설정</a>
                    <a th:href="@{/admin/config/car}" class="bc-item">차량 설정</a>
                    <a class="bc-item">상세</a>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">차량</span>
                </div>

                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">브랜드</div>
                        <div class="modal-item_content">
                            <select class="mi_select" name="modal_carManufacturer" id="modal_carManufacturer">

                            </select>
                        </div>
                    </div>

                    <div class="modal-item">
                        <div class="modal-item_title">모델</div>
                        <div class="modal-item_content">
                            <input id="car_model_name" class="mi_input" type="text">
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">세부모델</span>
                </div>

                <div class="content-item mt-15">
                    <div class="modal-item width-50p">
                        <div class="modal-item_title">세부모델</div>
                        <div class="modal-item_content border-box">
                            <input id="car_model_detail_name" class="mi_input" type="text">
                            <div id="btnCreateCarModel" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div id="car_model_div" class="tag-list">
                        <div class="tag">더 뉴 그랜져 (19년~현재)</div>
                        <div class="tag">더 뉴 그랜져 하이브리드 (19년~현재)</div>
                        <div class="tag">그랜져IG (16년~19년)</div>
                        <div class="tag">더 뉴 그랜져 하이브리드 (19년~현재)</div>
                        <div class="tag">그랜져IG (16년~19년)</div>
                        <div class="tag">더 뉴 그랜져 (19년~현재)</div>
                    </div>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">등급</span>
                </div>

                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">세부모델</div>
                        <div class="modal-item_content">
                            <select class="mi_select" name="" id="car_model_select">
                                <option value="">더 뉴 그랜져 (19년~현재)</option>
                                <option value="">더 뉴 그랜져 하이브리드 (19년~현재)</option>
                                <option value="">그랜져IG (16년~19년)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">등급</div>
                        <div class="modal-item_content">
                            <input id="car_class_name"class="mi_input" type="text">
                        </div>
                    </div>
                </div>

                <div class="content-item mt-15 flex-wrap">
                    <div class="modal-item width-50p mr-30 mobile-margin-0">
                        <div class="modal-item_title">배기량 (cc)</div>
                        <div class="modal-item_content">
                            <input id="car_class_displacement"class="mi_input" type="number">
                        </div>
                    </div>

                    <div class="modal-item width-40p ">
                        <div class="modal-item_title hidden">title</div>
                        <div class="modal-item_content flex-align border-none">
                            <div class="mi_check">
                                <div class="mi_check-item">
                                    <input type="radio" id="check-01" name="check-01" value="POPULAR" checked>
                                    <label for="check-01">인기</label>
                                </div>
                                <div class="mi_check-item">
                                    <input type="radio" id="check-02" name="check-01" value="UN_POPULAR">
                                    <label for="check-02">비인기</label>
                                </div>
                            </div>
                            <div id="btnCreateClass" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div class="tag-list" id="car_class_div">
                        <div class="tag">더 뉴 그랜져 (19년~현재)</div>
                        <div class="tag">더 뉴 그랜져 하이브리드 (19년~현재)</div>
                        <div class="tag">그랜져IG (16년~19년)</div>
                    </div>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">트림</span>
                </div>

                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">등급</div>
                        <div class="modal-item_content">
                            <select class="mi_select" name="" id="car_class_select">
                                <option value="">더 뉴 그랜져 (19년~현재)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="content-item mt-15 flex-wrap">
                    <div class="modal-item width-50p mr-30 mobile-margin-0">
                        <div class="modal-item_title">트림</div>
                        <div class="modal-item_content">
                            <input id="car_trim_name"class="mi_input" type="text">
                        </div>
                    </div>

                    <div class="modal-item width-40p ">
                        <div class="modal-item_title hidden">title</div>
                        <div class="modal-item_content flex-align border-none">
                            <div id="btnCreateTrim" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div class="tag-list" id="car_trim_div">
                        <div class="tag">더 뉴 그랜져 (19년~현재)</div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <!--
                <button class="mf_button btn-save hover01">저장</button>
                -->
                <button class="mf_button btn-close_modal hover02">닫기</button>
            </div>

            <div class="top-close btn-close_modal"><i class="xi-close"></i></div>
        </div>


        <div class="modal-wrapper main-modal modal-create_model width-600">
            <div class="modal-header">
                <div class="modal-title">
                    <span  class="mt-text">모델번호 ()</span>
                </div>
                <div class="breadcrumb">
                    <a th:href="@{/}" class="bc-item">Home</a>
                    <a class="bc-item">설정</a>
                    <a th:href="@{/admin/config/car}" class="bc-item">차량 설정</a>
                    <a class="bc-item">상세</a>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">차량</span>
                </div>

                <div class="content-item  mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">브랜드</div>
                        <div class="modal-item_content">
                            <select class="mi_select" name="modal_brand_carManufacturer" id="modal_brand_carManufacturer">

                            </select>
                        </div>
                    </div>
                </div>
            </div>


            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">차량모델</span>
                </div>
                <div id="input_car_model" class="content-item  mt-15">
                    <div id="car_model_input" class="modal-item">
                        <div class="modal-item_title">모델명</div>
                        <div class="modal-item_content">
                            <input id="modal_car_model_name" class="mi_input" type="text">
                        </div>
                    </div>

                    <div id="car_model_detail_input" class="modal-item">
                        <div class="modal-item_title">모델 상세명</div>
                        <div class="modal-item_content">
                            <input id="modal_car_model_detail_name" class="mi_input" type="text">
                        </div>
                    </div>

                    <div class="modal-item width-40p ">
                        <div class="modal-item_title hidden">title</div>
                        <div class="modal-item_content flex-align border-none">
                            <div id="btnCreateModel" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div id="model_tag" class="tag-list">

                    </div>

                </div>
                <div id="select_car_model">
                    <div class="content-item mt-15">
                        <div class="modal-item">
                            <div class="modal-item_title">모델</div>
                            <div class="modal-item_content">
                                <select class="mi_select" name="" id="modal_car_model_select">

                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="car_class_content" class="modal-content">
                <div class="content-title">
                    <span class="ct-title">등급</span>
                </div>
                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">등급</div>
                        <div class="modal-item_content">
                            <input id="modal_car_class_name"class="mi_input" type="text">
                        </div>
                    </div>
                </div>

                <div class="content-item mt-15 flex-wrap">
                    <div class="modal-item width-50p mr-30 mobile-margin-0">
                        <div class="modal-item_title">배기량 (cc)</div>
                        <div class="modal-item_content">
                            <input id="modal_car_class_displacement"class="mi_input" type="number">
                        </div>
                    </div>

                    <div class="modal-item width-40p ">
                        <div class="modal-item_title hidden">title</div>
                        <div class="modal-item_content flex-align border-none">
                            <div class="mi_check">
                                <div class="mi_check-item">
                                    <input type="radio" id="modal_check-01" name="modal_check-01" value="POPULAR" checked>
                                    <label for="modal_check-01">인기</label>
                                </div>
                                <div class="mi_check-item">
                                    <input type="radio" id="modal_check-02" name="modal_check-02" value="UN_POPULAR">
                                    <label for="modal_check-02">비인기</label>
                                </div>
                            </div>
                            <div id="btnCreateCarClass" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div class="tag-list" id="modal_car_class_div">
                        <div class="tag">더 뉴 그랜져 (19년~현재)</div>
                        <div class="tag">더 뉴 그랜져 하이브리드 (19년~현재)</div>
                        <div class="tag">그랜져IG (16년~19년)</div>
                    </div>
                </div>
            </div>


            <div class="modal-footer">
                <!--
                <button id="btnCreateModel"class="mf_button btn-save hover01">저장</button>
                -->
                <button class="mf_button btn-close_modal hover02">닫기</button>
            </div>

            <div class="top-close btn-close_modal"><i class="xi-close"></i></div>
        </div>


        <div class="modal-wrapper main-modal modal-setting_brand width-400">
            <div class="modal-header">
                <div class="modal-title">
                    <span class="mt-text">브랜드 설정</span>
                </div>
                <div class="breadcrumb">
                    <a class="bc-item">Home</a>
                    <a class="bc-item">설정</a>
                    <a class="bc-item">차량 설정</a>
                    <a class="bc-item">브랜드</a>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">국산 브랜드</span>
                </div>

                <div class="content-item mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">신규 국산 브랜드</div>
                        <div class="modal-item_content border-box">
                            <input id="domestic_brand" class="mi_input" type="text">
                            <div id="btnCreateDomestic"class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div id="domestic_carmanufacturer" class="tag-list">

                    </div>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">수입 브랜드</span>
                </div>

                <div class="content-item mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">신규 수입 브랜드</div>
                        <div class="modal-item_content border-box">
                            <input id="international_brand"class="mi_input" type="text">
                            <div id="btnCreateInternational" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div id="international_carmanufacturer" class="tag-list">
                    </div>
                </div>
            </div>
            <!--
            <div class="modal-content">
                <div class="content-title flex-between">
                    <span class="ct-title">고정 브랜드 선택</span>
                    <div class="mi_check">
                        <div class="mi_check-item">
                            <input type="radio" id="check-03" name="domestic" value="domestic" checked>
                            <label for="check-03">국산</label>
                        </div>
                        <div class="mi_check-item">
                            <input type="radio" id="check-04" name="international" value="international">
                            <label for="check-04">수입</label>
                        </div>
                    </div>
                </div>

                <div class="content-item mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">브랜드</div>
                        <div class="modal-item_content border-box">
                            <select class="mi_select" name="modal_fix_brand" id="modal_fix_brand">

                            </select>
                            <div id="btnFixBrand" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div class="tag-list" id="fix_carManufacturer">

                    </div>
                </div>
            </div>
            <div class="row mb-10 right-align"><span class="p-red">고정 브랜드는 최대 9개까지 선택 가능합니다.</span></div>
            -->
            <div class="modal-footer">

                <button id="btnSaveBrand" class="mf_button btn-save hover01">저장</button>
                <button class="mf_button btn-close_modal hover02">닫기</button>
            </div>

            <div class="top-close btn-close_modal"><i class="xi-close"></i></div>
        </div>

        <div class="modal-wrapper main-modal modal-setting_color width-400">
            <div class="modal-header">
                <div class="modal-title">
                    <span class="mt-text">색상</span>
                </div>
                <div class="breadcrumb">
                    <a class="bc-item">Home</a>
                    <a class="bc-item">설정</a>
                    <a class="bc-item">차량 설정</a>
                    <a class="bc-item">색상</a>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">색상</span>
                </div>

                <div class="content-item mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">색상</div>
                        <div class="modal-item_content border-box">
                            <input id="in_car_color" class="mi_input" type="text">
                            <div id="btnCreateColor" class="modal-item-button btn-enroll_model hover03">등록</div>
                        </div>
                    </div>

                    <div id="car_color" class="tag-list">
                        <div class="tag">블루</div>
                        <div class="tag">블랙</div>
                        <div class="tag">화이트</div>
                        <div class="tag">그린</div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <!--
                <button class="mf_button btn-save hover01">저장</button>
                -->
                <button class="mf_button btn-close_modal hover02">닫기</button>
            </div>

            <div class="top-close btn-close_modal"><i class="xi-close"></i></div>
        </div>

        <div class="modal-wrapper main-modal modal-detail width-600">
            <div class="modal-header">
                <div class="modal-title">
                    <input type="hidden" id="car_class_id"/>
                    <span id="modal_detail_id" class="mt-text">모델번호()</span>
                </div>
                <div class="breadcrumb">
                    <a th:href="@{/}" class="bc-item">Home</a>
                    <a class="bc-item">설정</a>
                    <a th:href="@{/admin/config/car}" class="bc-item">차량 설정</a>
                    <a class="bc-item">상세</a>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">차량</span>
                </div>

                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">브랜드</div>
                        <div class="modal-item_content">
                            <input id="detail_car_manufacturer" class="mi_input" type="text" readonly="readonly">
                        </div>
                    </div>

                    <div class="modal-item">
                        <div class="modal-item_title">모델</div>
                        <div class="modal-item_content">
                            <input id="detail_car_model_name" class="mi_input" type="text" readonly="readonly">
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">세부모델</span>
                </div>

                <div class="content-item mt-15">
                    <div class="modal-item width-50p">
                        <div class="modal-item_title">세부모델</div>
                        <div class="modal-item_content border-box">
                            <input id="detail_car_model_detail" class="mi_input" type="text" readonly="readonly">
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">등급</span>
                </div>

                <div class="content-item flex-row-2 mt-15">
                    <div class="modal-item">
                        <div class="modal-item_title">등급</div>
                        <div class="modal-item_content">
                            <input id="detail_car_class_name" class="mi_input" type="text" readonly="readonly">
                        </div>
                    </div>

                    <div class="modal-item">
                        <div class="modal-item_title">배기량</div>
                        <div class="modal-item_content">
                            <input id="detail_car_class_displacement" class="mi_input" type="text" readonly="readonly">
                        </div>
                    </div>
                </div>

                <div class="content-item mt-15 flex-wrap">
                    <div class="modal-item width-50p mr-30 mobile-margin-0">
                        <div class="modal-item_title">인기여부</div>
                        <div class="modal-item_content">
                            <select class="mi_select" name="detail_car_class_popular_type" id="detail_car_class_popular_type">
                                <option value="POPULAR">인기</option>
                                <option value="UN_POPULAR">비인기</option>
                            </select>
                        </div>
                    </div>
                </div>


            </div>

            <div class="modal-content">
                <div class="content-title">
                    <span class="ct-title">트림</span>
                </div>

                <div class="content-item mt-15 flex-wrap">
                    <div class="modal-item width-50p mr-30 mobile-margin-0">
                        <div class="modal-item_title">트림</div>
                        <div class="modal-item_content">
                            <input id="detail_car_trim_name"class="mi_input" type="text" readonly="readonly">
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <!--
                <button id="btnModifyCarTrim" class="mf_button btn-save hover01">수정<button>
                -->
                <button id="btnDeleteCarTrim" class="mf_button btn-save hover01">삭제</button>
                <button class="mf_button btn-close_modal hover02">닫기</button>
            </div>
            <div class="top-close btn-close_modal"><i class="xi-close"></i></div>
        </div>

    </div>
</div>

<script>
    let search = ""
    let fix_domestic_brand = [];
    let fix_international_brand = [];
    let domestic_brand = [];
    let international_brand = [];

    let delete_car_manufacturer_list = [];
    let add_car_manufacturer_list = [];


    let carManufacturer_lsit = [];
    let carModel_list = [];

    let saveMap = new Map();

    $(function(){
        $('#btnCreateNew').on('click', activeModal_RegistryModel);
        $('#btnCreateNewClass').on('click', activeModal_CreateCarClass);

        $('.btn-setting_brand').on('click', activeModal_SettingBrand);
        $('.btn-setting_color').on('click', activeModal_SettingColor);
        $('.table-body .t-item').on('click', activeModal_Detail);

        search = $('#searchText').val();
        $('#btnSearch').click(function () {
           if(!$('#searchText').val()) {
               alert("검색어를 입력해 주세요.");
               return;
           }

           Common.goPage('/admin/config/car?search=' + $('#searchText').val());
        });

        $('#btnCreateDomestic').click(function (){
            if(!$.notnull($('#domestic_brand') , '브랜드명'))
                return false;

            let name = $('#domestic_brand').val();
            let addObj = {};
            addObj.name = name;
            addObj.nameKr = name;
            addObj.nameEng = name;
            addObj.countryType = 'DOMESTIC';
            addObj.country = 'KOREA';
            add_car_manufacturer_list.push(addObj);
            domestic_brand.push(addObj);

            let appendHtml = `<div class="tag" name="carManufacturer" brand-name="${name}"  >${name}</div>`;
            $('#domestic_carmanufacturer').append(appendHtml);

            //Service.createCarManufacturer($('#domestic_brand').val(), 'DOMESTIC' , 'KOREA');
        });
        $('#btnCreateInternational').click(function (){
            if(!$.notnull($('#international_brand') , '브랜드명'))
                return false;

            let name = $('#international_brand').val();
            let addObj = {};
            addObj.name = name;
            addObj.nameKr = name;
            addObj.nameEng = name;
            addObj.countryType = 'INTERNATIONAL';
            addObj.country = 'GERMANY';
            add_car_manufacturer_list.push(addObj);
            international_brand.push(addObj);

            let appendHtml = `<div class="tag" name="carManufacturer" brand-name="${name}"  >${name}</div>`;
            $('#international_carmanufacturer').append(appendHtml);

            //Service.createCarManufacturer($('#international_brand').val(), 'INTERNATIONAL' , 'GERMANY');
        });
        $('#btnFixBrand').click(function (){
            let name = $('#modal_fix_brand option:selected').val();
            let id = $('#modal_fix_brand option:selected').attr('option-id');

            if(fix_domestic_brand.length + fix_international_brand.length > 9) {
                alert('고정 브랜드는 최대 9개 까지 가능합니다.');
                return;
            }
            Service.updateCarManufacturerPublish(id, true);
        });
        $('#btnCreateColor').click(function (){
            if(!$.notnull($('#in_car_color') , '색상'))
                return false;
            Service.createCarColor($('#in_car_color').val());
        });

        $('.btn-close_modal').click(function () {
            Common.reloadPage();
        });

        $('#btnCreateModel').click(function () {
            let name = $('#modal_car_model_name').val();
            let nameDetail = $('#modal_car_model_detail_name').val();
            let carManufacturerId = $('#modal_brand_carManufacturer option:selected').val();
            if(!name || !nameDetail) {
                alert('모델명을 입력해주세요');
                return;
            }
            if(!carManufacturerId) {
                alert('브랜드를 선택해주세요.');
                return;
            }
            Service.createCarModel(carManufacturerId, name, nameDetail);
        });

        $('#btnCreateCarClass').click(function () {
            let carManufacturerId = $('#modal_brand_carManufacturer option:selected').val();
            let carModelId = $('#modal_car_model_select option:selected').val();
            if(!carManufacturerId || !carModelId) {
                alert('브랜드와 모델을 선택해주세요');
                return;
            }
            let carClassName = $('#car_class_name').val();
            let carDisplacement = $('#car_class_displacement').val();
            if(!carClassName || !carDisplacement) {
                alert('등급명과 배기량을 입력해주세요');
                return;
            }
            let popularType = $('input:radio[name=modal_check-01]:checked').val();
            Service.createCarClass(carModelId, carClassName, carDisplacement, popularType);
        });

        $('#btnDeleteCarTrim').click(function () {
            let result = confirm('해당 모델을 삭제하시겠습니까?');
            if(result){
                Service.deleteCarTrimWithParent($('#car_class_id').val(), true);
            }
        });
        $('#btnModifyCarTrim').click(function () {
            let result = confirm('해당 모델을 수정하시겠습니까?');
            if(result){
                Service.modifyCarTrimWithParent($('#car_class_id').val(), true);
            }
        });

        $('#btnSaveBrand').click(function () {
            let result = confirm('모델정보를 저장 하시겠습니까?');
            if(result){
                Service.saveBrand();
            }
        });

        $(document).on('click', 'div[name=carManufacturer]', function() {
            //Service.deleteCarManufacturer($(this).attr('id'), false);
            $(this).remove();
            let name = $(this).attr('brand-name');

            let deleteObj = {};
            deleteObj.name = name;
            delete_car_manufacturer_list.push(deleteObj);
            //console.log($(this).attr('id'));
        });

        $(document).on('click', 'div[name=fix_carManufacturer]', function() {
            Service.updateCarManufacturerPublish($(this).attr('id'), false);
            //console.log($(this).attr('id'));
        });
        $(document).on('click', 'div[name=carColor]', function() {
            Service.deleteCarColor($(this).attr('color-id'), false);
            //console.log($(this).attr('id'));
        });
        $(document).on('click', 'div[name=car-model]', function() {
            Service.deleteCarModel($(this).attr('car-model-id'));
        });
        $(document).on('click', 'div[name=car-class]', function() {
            Service.deleteCarClass($(this).attr('car-class-id'), false);
        });
        $(document).on('click', 'div[name=car-trim]', function() {
            Service.deleteCarTrim($(this).attr('car-trim-id'), false);
        });
        $(document).on('click', 'div[name=car-model-tag]', function() {
            let result = confirm('해당 모델을 정말로 삭제하시겠습니까? 해당 모델 차량데이터가 모두 삭제됩니다.');
            if(result) {
                Service.deleteCarModel($(this).attr('car-model-id'));
            }
        });



        $(document).on('change', 'select[name=modal_brand_carManufacturer]', function() {
            if(this.value) {
                console.log(this.value);
                Service.getCarModels(this.value);
            } else {
                $('#model_tag').empty();
            }
        });



        $('input:radio[name=domestic]').change(function (){
            $('input:radio[name=international]').prop('checked', false);
            Service.initFixBrandView();
        });

        $('input:radio[name=international]').change(function (){
            $('input:radio[name=domestic]').prop('checked', false);
            Service.initFixBrandView();
        });

        $('#btnCreateCarModel').click(function (){
            if(!$.notnull($('#car_model_name') , '모델명'))
                return false;
            if(!$.notnull($('#car_model_detail_name') , '세부모델명'))
                return false;

            /*
            let carManufaturer = $('#modal_carManufacturer option:selected').text();
            createCarModelInfo(carManufaturer, $('#car_model_name').val(), $('#car_model_detail_name').val());
            */

            let carManufaturerId = $('#modal_carManufacturer option:selected').val();
            let modelName = $('#car_model_name').val();
            let modelNameDetail = $('#car_model_detail_name').val();
            Service.createCarModel(carManufaturerId, modelName, modelNameDetail);

        });

        $('#btnCreateClass').click(function () {
            if(!$.notnull($('#car_class_name') , '등급'))
                return false;
            if(!$.notnull($('#car_class_displacement') , '배기량'))
                return false;

            let carModelId = $('#car_model_select option:selected').val();
            let carClassName = $('#car_class_name').val();
            let carDisplacement = $('#car_class_displacement').val();

            let popularType = $('input:radio[name=check-01]:checked').val();
            Service.createCarClass(carModelId, carClassName, carDisplacement, popularType);
        });

        $('#btnCreateTrim').click(function () {
            if(!$.notnull($('#car_trim_name') , '트림'))
                return false;
            let carClassId = $('#car_class_select option:selected').val();
            let carTrimName = $('#car_trim_name').val();
            Service.createCarTrim(carClassId, carTrimName);
        });

    });

    $('div[name=carManufacturer]').on('click', function(){
        console.log($(this).attr(id));
    });

    function deleteCarModelAndViewSetting(carModelId) {
        $('#car_model_div').children().each(function (index, element) {
            let modelId = $(this).attr('car-model-id');
            if(modelId == carModelId) {
                $(this).remove();
            }
            console.log('div id ' + modelId);
        });
        $('#car_model_select').children().each(function (index, element) {
            if($(this).val() == carModelId) {
                $(this).remove();
            }
            console.log('select id ' + $(this).val());
        });

        $('#car_class_div').children().each(function (index ,item) {
            if($(this).attr("car-model-id") == carModelId) {
                $(this).remove();
                deleteCarClassAndViewSetting($(this).attr('car-class-id'));
            }
        });
    }

    function deleteCarClassAndViewSetting(carClassId) {
        $('#car_class_div').children().each(function (index, element) {
            if($(this).attr('car-class-id') == carClassId) {
                $(this).remove();
            }
        });
        $('#car_class_select').children().each(function (index, element) {
            if($(this).attr('car-class-id') == carClassId) {
                $(this).remove();
            }
        });
        $('#car_trim_div').children().each(function (index, element) {
            if($(this).attr('car-class-id') == carClassId) {
                $(this).remove();
                deleteCarTrimAndViewSetting($(this).attr('car-trim-id'));
            }
        });
    }
    function deleteCarTrimAndViewSetting(carTrimId) {
        $('#car_trim_div').children().each(function (index, element) {
            if($(this).attr('car-trim-id') == carTrimId) {
                $(this).remove();
            }
        });
    }

    function settingRegisterView() {
        $('#car_model_div').empty();
        saveMap.forEach(function(carModelMap, key, mapObj) {
            carModelMap.forEach(function(value, key, mapObj) {
                let modelDivHtml = `<div class="tag" name="${key}">${value.name} ${value.trim}</div>`;
                $('#car_model_div').append(modelDivHtml);
            });
        });

    }

    function createCarModelInfo(carManufaturer, modelName, modelTrim) {
        let modelMap = saveMap.get(carManufaturer);
        if(!modelMap){
            modelMap = new Map();
            let classMap = new Map();
            modelMap.set(modelName+modelTrim, classMap);
            saveMap.set(carManufaturer, modelMap);
        } else {
            let classMap = modelMap.get(modelName+modelTrim);

            modelObj.name = modelName;
            modelObj.trim = modelTrim;
            modelMap.set(modelName+modelTrim, modelObj);
            saveMap.set(carManufaturer, modelMap);
        }
        settingRegisterView();
    }

    function createCarClassInfo(carManufaturer, modelName, modelTrim, carClass, popularYn){
        let modelMap = saveMap.get(carManufaturer);
        modelMap.get(modelName+modelTrim);
    }

    function activeModal_RegistryModel(){
        $('#car_model_div').empty();
        $('#car_model_select').empty();
        $('#car_class_div').empty();
        $('#car_class_select').empty();
        $('#car_trim_div').empty();
        saveMap.clear();
        Service.getAllCarManufacturer(function () {
            createCarModelViewSetting();
            settingModalView();
        });
    }

    function activeModal_CreateCarClass(){
        Service.getAllCarManufacturer(function () {
            createCarClassViewSetting();
            settingModalView();
        });
    }

    function settingModalView() {
        $('#modal_brand_carManufacturer').empty();
        let optionHtml = `<option value="" manufacturer-id="">브랜드를 선택하세요.</option>`;
        $('#modal_brand_carManufacturer').append(optionHtml);
        for (let i = 0; i < carManufacturer_lsit.length; i++) {
            let inner = carManufacturer_lsit[i];
            let optionHtml = `<option value="${inner.id}" manufacturer-id="${inner.id}">${inner.name}</option>`;
            $('#modal_brand_carManufacturer').append(optionHtml);
        }
        openLayer();
        $('.modal-create_model').addClass('active');
    }

    function createCarModelViewSetting() {
        $('#select_car_model').hide();
        $('#car_class_content').hide();
        $('#input_car_model').show();
    }

    function createCarClassViewSetting() {
        $('#select_car_model').show();
        $('#car_class_content').show();
        $('#input_car_model').hide();
        $('#modal_car_class_div').empty();
    }

    function createCarTrimViewSetting() {

    }

    function activeModal_SettingBrand(){
        delete_car_manufacturer_list = [];
        add_car_manufacturer_list = [];
        $('#domestic_brand').val('');
        $('#international_brand').val('');
        Service.getCarBrand();
    }

    function activeModal_SettingColor(){
        Service.getCarColors();
    }

    function activeModal_Detail() {
        Service.getCarTrimDetail($(this).attr('id'));
    }

    function searchValue(size) {
        let url = `/admin/config/car?page=0&size=`+ size;
        if($('#search').val()) {
            url += '&search=' + $('#search').val();
        }
        Common.goPage(url);
    }

    function excelDownload() {
        let url = `/admin/config/car/excel/download?page=` + $('#page').val() + `&size=`+ $('#size').val();
        if($('#search').val()) {
            url += '&search=' + $('#search').val();
        }
        Common.goPage(url);
    }

    let Service = {
        getCarModels: function (carManufacturerId) {
            let obj = {};
            var url = "/api/admin/v1/car_model/car_manufacturer/" + carManufacturerId;
            var ajaxParam = {
                "url": url,
                "type": "GET",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    $('#model_tag').empty();
                    $('#modal_car_model_select').empty();
                    let optionHtml = `<option value="">선택해주세요.</option>`;
                    $('#modal_car_model_select').append(optionHtml);
                    for (let i = 0; i < data.data.length; i++) {
                        let inner = data.data[i];
                        let tagHtml = `<div class="tag" name="car-model-tag" car-model-id="${inner.id}" className="tag">${inner.name} ${inner.nameDetail}</div>`;
                        $('#model_tag').append(tagHtml);
                        let optionHtml = `<option value="${inner.id}">${inner.name} ${inner.nameDetail}</option>`;
                        $('#modal_car_model_select').append(optionHtml);
                    }
                    return;
                }
                return;
            });
        },
        saveBrand: function () {
            let obj = {};
            obj.deleteList = delete_car_manufacturer_list;
            obj.addList = add_car_manufacturer_list;
            var url = "/api/admin/v1/car_manufacturer/all";
            var ajaxParam = {
                "url": url,
                "type": "PUT",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    delete_car_manufacturer_list = [];
                    add_car_manufacturer_list = [];
                    alert(data.message);
                    return;
                }
                return;
            });
        },
        getCarTrimDetail: function (carTrimId) {
            let obj = {};
            var url = "/api/admin/v1/car_trim/" + carTrimId;
            var ajaxParam = {
                "url": url,
                "type": "GET",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {

                    $('#car_class_id').val(data.data.id);
                    $('#modal_detail_id').text('모델번호 ' + data.data.id);
                    $('#detail_car_manufacturer').val(data.data.carManufacturer);
                    $('#detail_car_model_name').val(data.data.carModel);
                    $('#detail_car_model_detail').val(data.data.carModelDetail);

                    $('#detail_car_class_name').val(data.data.carClass);
                    $('#detail_car_class_displacement').val(data.data.carDisplacement);

                    $('#detail_car_trim_name').val(data.data.name);
                    let popularType = '비인기';
                    if(data.data.popularType == 'POPULAR') {
                        popularType = '인기';
                    }
                    $('#detail_car_class_popular_type').val(data.data.popularType);
                    openLayer();
                    $('.modal-detail').addClass('active');
                }
                return;
            });
        },
        getCarClassDetail: function (carClassId) {
            let obj = {};
            var url = "/api/admin/v1/car_class/" + carClassId;
            var ajaxParam = {
                "url": url,
                "type": "GET",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    $('#car_class_id').val(data.data.id);
                    $('#modal_detail_id').text('모델번호 ' + data.data.id);
                    $('#detail_car_manufacturer').val(data.data.carManufacturer.name);
                    $('#detail_car_model_name').val(data.data.carModel.name);
                    $('#detail_car_model_trim').val(data.data.carModel.trim);
                    $('#detail_car_class_name').val(data.data.name);
                    let popularType = '비인기';
                    if(data.data.popularType == 'POPULAR') {
                        popularType = '인기';
                    }
                    $('#detail_car_class_popular_type').val(data.data.popularType);
                    openLayer();
                    $('.modal-detail').addClass('active');
                }
                return;
            });
        },
        deleteCarTrim: function (carTrimId, isfromModal) {
            let obj = {};
            var url = "/api/admin/v1/car_trim/" + carTrimId;
            var ajaxParam = {
                "url": url,
                "type": "DELETE",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    if(isfromModal) {
                        closeLayer();
                        $('.modal-detail').removeClass('active');
                        Common.reloadPage();
                    } else {
                        deleteCarTrimAndViewSetting(carTrimId);
                    }
                }
                return;
            });
        },
        modifyCarTrimWithParent: function (carTrimId) {
            let obj = {};
            var url = "/api/admin/v1/car_trim/" + carTrimId + "/with_parent";
            var ajaxParam = {
                "url": url,
                "type": "PUT",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    closeLayer();
                    $('.modal-detail').removeClass('active');
                    Common.reloadPage();
                }
                return;
            });
        },
        deleteCarTrimWithParent: function (carTrimId, isfromModal) {
            let obj = {};
            var url = "/api/admin/v1/car_trim/" + carTrimId + "/with_parent";
            var ajaxParam = {
                "url": url,
                "type": "DELETE",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    if(isfromModal) {
                        closeLayer();
                        $('.modal-detail').removeClass('active');
                        Common.reloadPage();
                    } else {
                        deleteCarTrimAndViewSetting(carTrimId);
                    }
                }
                return;
            });
        },


        deleteCarClass: function (carClassId, fromDetailModal) {
            let obj = {};
            var url = "/api/admin/v1/car_class/" + carClassId;
            var ajaxParam = {
                "url": url,
                "type": "DELETE",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    if(!fromDetailModal){
                        deleteCarClassAndViewSetting(carClassId);
                    } else {
                        closeLayer();
                        $('.modal-detail').removeClass('active');
                        Common.reloadPage();
                    }
                }
                return;
            });
        },
        createCarClass: function (carModelId, carClassName, carDisplacement, popularType) {
            let obj = {};
            obj.carModelId = carModelId;
            obj.carClassName = carClassName;
            obj.popularType = popularType;
            obj.carClassDisplacement = carDisplacement;

            var url = "/api/admin/v1/car_class";
            var ajaxParam = {
                "url": url,
                "type": "POST",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    let innerHtml = `<div class="tag" name="car-class" car-model-id="${carModelId}" car-class-id="${data.data.id}">${data.data.name} ${data.data.carDisplacement} (cc) </div>`;
                    $('#car_class_div').append(innerHtml);
                    let optionHtml = `<option car-class-id="${data.data.id}" value="${data.data.id}">${data.data.name} ${data.data.carDisplacement} (cc)</option>`;
                    $('#car_class_select').append(optionHtml);
                }
                return;
            });
        },

        createCarTrim: function (carClassId, carTrimName) {
            let obj = {};
            obj.carClassId = carClassId;
            obj.carTrimName = carTrimName;
            var url = "/api/admin/v1/car_trim";
            var ajaxParam = {
                "url": url,
                "type": "POST",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    let innerHtml = `<div class="tag" name="car-trim" car-class-id="${carClassId}" car-trim-id="${data.data.id}">${data.data.name}</div>`;
                    $('#car_trim_div').append(innerHtml);
                }
                return;
            });
        },

        deleteCarModel: function (carModelId) {
            let obj = {};
            var url = "/api/admin/v1/car_model/" + carModelId;
            var ajaxParam = {
                "url": url,
                "type": "DELETE",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    deleteCarModelAndViewSetting(carModelId);
                    $('div[car-model-id=' + carModelId + ']').remove();
                }
                return;
            });
        },
        createCarModel: function (carManufacturerId, modelName, modelNameDetail) {
            let obj = {};
            obj.carManufacturerId = carManufacturerId;
            obj.carModelName = modelName;
            obj.carModelNameDetail = modelNameDetail;
            var url = "/api/admin/v1/car_model";
            var ajaxParam = {
                "url": url,
                "type": "POST",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    let innerHtml = `<div class="tag" name="car-model" car-model-id="${data.data.id}">${data.data.name} ${data.data.nameDetail}</div>`;
                    $('#car_model_div').append(innerHtml);
                    let optionHtml = `<option value="${data.data.id}">${data.data.name} ${data.data.nameDetail}</option>`;
                    $('#car_model_select').append(optionHtml);

                    let tagHtml = `<div class="tag" name="car-model-tag" car-model-id="${data.data.id}" className="tag">${data.data.name} ${data.data.nameDetail}</div>`;
                    $('#model_tag').append(tagHtml);

                }
                return;
            });
        },
        getAllCarManufacturer: function (_func) {
            let obj = {};
            var url = "/api/admin/v1/car_manufacturer";
            var ajaxParam = {
                "url": url,
                "type": "GET",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    carManufacturer_lsit = [];
                    carManufacturer_lsit = data.data;
                    _func();
                }
                return;
            });
        },

        deleteCarColor: function (id){
            let obj = {};
            var url = "/api/admin/v1/car_color/" + id;
            var ajaxParam = {
                "url": url,
                "type": "DELETE",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    let innerHtml = "";
                    $('div[color-id=' + id + ']').remove();
                }
                return;
            });
        },
        createCarColor: function (color) {
            let obj = {};
            var url = "/api/admin/v1/car_color";
            obj.color = color;
            var ajaxParam = {
                "url": url,
                "type": "POST",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    let innerHtml = "";
                    innerHtml += `<div class="tag" name="carColor" color-id="${data.data.id}">${data.data.color}</div>`;
                    $('#car_color').append(innerHtml);
                    $('#in_car_color').val('');
                }
                return;
            });
        },
        getCarColors: function () {
            let obj = {};
            var url = "/api/admin/v1/car_color";
            var ajaxParam = {
                "url": url,
                "type": "GET",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {

                    $('#car_color').empty();
                    for (let i = 0; i < data.data.length; i++) {
                        let inner = data.data[i];
                        let innerHtml = "";
                        innerHtml += `<div class="tag" name="carColor" color-id="${inner.id}">${inner.color}</div>`;
                        $('#car_color').append(innerHtml);
                    }
                    openLayer();
                    $('.modal-setting_color').addClass('active');
                }
                return;
            });

        },
        getCarBrand : function () {
            let obj = {};
            var url = "/api/admin/v1/car_manufacturer";
            var ajaxParam = {
                "url": url,
                "type": "GET",
                "data": ""
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    fix_domestic_brand = [];
                    fix_international_brand = [];
                    international_brand = [];
                    domestic_brand = [];

                    $('#domestic_carmanufacturer').empty();
                    $('#international_carmanufacturer').empty();
                    for (let i = 0; i < data.data.length; i++) {
                        let inner = data.data[i];
                        let innerHtml = "";
                        innerHtml += `<div class="tag" name="carManufacturer" brand-name="${inner.name}" id="${inner.id}">${inner.name}</div>`;
                        if(inner.countryType == 'DOMESTIC') {
                            $('#domestic_carmanufacturer').append(innerHtml);
                            if(inner.published == true ){
                                fix_domestic_brand.push(inner);
                            } else {
                                domestic_brand.push(inner);
                            }
                        } else {
                            $('#international_carmanufacturer').append(innerHtml);
                            if(inner.published == true ){
                                fix_international_brand.push(inner);
                            } else {
                                international_brand.push(inner);
                            }
                        }
                    }
                    Service.initFixBrandView();
                    openLayer();
                    $('.modal-setting_brand').addClass('active');
                }
                return;
            });
        },

        initFixBrandView: function (){
            $('#fix_carManufacturer').empty();
            $('#modal_fix_brand').empty();

            if($('input:radio[name=domestic]').is(':checked')) {
                // 라디오가 국산 선택이라면
                fix_domestic_brand.forEach(function (item) {
                    let innerHtml = `<div class="tag" name="fix_carManufacturer" id="${item.id}">${item.name}</div>`;
                    $('#fix_carManufacturer').append(innerHtml);
                });

                domestic_brand.forEach(function (item) {
                    let optionHtml = `<option value="${item.name}" option-id="${item.id}">${item.name}</option>`;
                    $('#modal_fix_brand').append(optionHtml);
                });

            } else {
                fix_international_brand.forEach(function (item) {
                    let innerHtml = `<div class="tag" name="fix_carManufacturer" id="${item.id}">${item.name}</div>`;
                    $('#fix_carManufacturer').append(innerHtml);
                });
                international_brand.forEach(function (item) {
                    let optionHtml = `<option value="${item.name}" option-id="${item.id}">${item.name}</option>`;
                    $('#modal_fix_brand').append(optionHtml);
                });

            }
        },

        updateCarManufacturerPublish: function (id, published) {
            let obj = {};
            obj.published = published;
            var url = "/api/admin/v1/car_manufacturer/" + id + "/published";
            var ajaxParam = {
                "url": url,
                "type": "PUT",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    if(published) {
                        Service.deleteItemInArray(id, data.data.countryType, false);
                        if(data.data.countryType == 'DOMESTIC') {
                            fix_domestic_brand.push(data.data);
                        } else {
                            fix_international_brand.push(data.data);
                        }
                    } else {
                        Service.deleteItemInArray(id, data.data.countryType, true);
                        if(data.data.countryType == 'DOMESTIC') {
                            domestic_brand.push(data.data);
                        } else {
                            international_brand.push(data.data);
                        }
                    }
                    Service.initFixBrandView();
                }
                return;
            });
        },




        createCarManufacturer : function (name, countryType, country){
            let obj = {};
            var url = "/api/admin/v1/car_manufacturer";
            obj.name = name;
            obj.countryType = countryType;
            obj.country = country;
            var ajaxParam = {
                "url": url,
                "type": "POST",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    if(countryType == 'DOMESTIC') {
                        let appendHtml = `<div class="tag" name="carManufacturer" id="${data.data.id}" >${name}</div>`;
                        $('#domestic_carmanufacturer').append(appendHtml);
                        domestic_brand.push(data.data);
                    } else {
                        let appendHtml = `<div class="tag" name="carManufacturer" id="${data.data.id}" >${name}</div>`;
                        $('#international_carmanufacturer').append(appendHtml);
                        international_brand.push(data.data);
                    }
                    Service.initFixBrandView();
                }
                return;
            });
        },
        deleteCarManufacturer: function (id, isFixData) {
            let obj = {};
            var url = "/api/admin/v1/car_manufacturer/" + id;
            var ajaxParam = {
                "url": url,
                "type": "DELETE",
                "data": JSON.stringify(obj)
            }
            Common.ajaxJSONV2(ajaxParam, function (data) {
                if (!data) {
                    alert('return data error');
                    return false;
                }
                if (data.result != 0) {
                    alert(data.message);
                    return;
                } else {
                    $('#' + id).remove();
                    Service.deleteItemInArray(id, data.data.countryType, isFixData);
                    Service.initFixBrandView();
                }
                return;
            });
        },

        deleteItemInArray: function (deleteId, countryType, isFixData) {
            if(countryType == 'DOMESTIC') {
                if(!isFixData){
                    let itemToFind = domestic_brand.find(function (item) {
                        console.log(item.id + " " + deleteId);
                        return item.id == deleteId;
                    });
                    console.log(itemToFind);
                    let index = domestic_brand.indexOf(itemToFind);
                    if(index > -1) domestic_brand.splice(index, 1);
                    console.log(index);
                } else {
                    let itemToFind = fix_domestic_brand.find(function (item) {
                        return item.id == deleteId;
                    });
                    let index = fix_domestic_brand.indexOf(itemToFind);
                    if(index > -1) fix_domestic_brand.splice(index, 1);
                }

            } else {
                if(!isFixData) {
                    let itemToFind = international_brand.find(function (item) {
                        return item.id == deleteId;
                    });
                    let index = international_brand.indexOf(itemToFind);
                    if(index > -1) international_brand.splice(index, 1);
                } else {
                    let itemToFind = fix_international_brand.find(function (item) {
                        return item.id == deleteId;
                    });
                    let index = fix_international_brand.indexOf(itemToFind);
                    if(index > -1) fix_international_brand.splice(index, 1);
                }
            }

        }
    }


</script>